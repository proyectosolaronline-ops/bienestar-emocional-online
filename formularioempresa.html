<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cotizaci√≥n Empresa ‚Äî Bienestar Emocional</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Jost:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root{
    --rosa:#FF85C0;--lila:#A67FFF;--lila-deep:#6B48CC;
    --verde:#4ECDC4;--bg:#F7FFFD;--card:#fff;
    --text:#142420;--muted:#5A7A75;--border:#D8F0EC;
  }
  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
  body{font-family:'Jost',sans-serif;background:var(--bg);min-height:100vh;display:flex;align-items:flex-start;justify-content:center;padding:32px 16px;overflow-x:hidden}
  body::before{content:'';position:fixed;top:-140px;right:-140px;width:480px;height:480px;border-radius:50%;background:radial-gradient(circle,rgba(78,205,196,.12) 0%,transparent 70%);pointer-events:none}
  body::after{content:'';position:fixed;bottom:-120px;left:-120px;width:420px;height:420px;border-radius:50%;background:radial-gradient(circle,rgba(166,127,255,.1) 0%,transparent 70%);pointer-events:none}

  .card{width:100%;max-width:560px;background:var(--card);border-radius:28px;box-shadow:0 2px 8px rgba(78,205,196,.08),0 18px 60px rgba(78,205,196,.13);overflow:hidden;animation:up .5s cubic-bezier(.22,.68,0,1.15) both}
  @keyframes up{from{opacity:0;transform:translateY(24px)}to{opacity:1;transform:translateY(0)}}

  /* Header verde-lila */
  .hdr{background:linear-gradient(145deg,#4ECDC4 0%,#6DBEAA 40%,#A67FFF 100%);padding:36px 36px 48px;position:relative}
  .hdr::after{content:'';position:absolute;bottom:0;left:0;right:0;height:32px;background:var(--card);border-radius:28px 28px 0 0}
  .badge{display:inline-flex;align-items:center;gap:6px;background:rgba(255,255,255,.22);color:#fff;padding:5px 13px;border-radius:50px;font-size:.76rem;font-weight:600;letter-spacing:.04em;text-transform:uppercase;margin-bottom:14px}
  .hdr h1{font-family:'Cormorant Garamond',serif;color:#fff;font-size:1.9rem;font-weight:700;line-height:1.2}
  .hdr p{color:rgba(255,255,255,.82);font-size:.88rem;margin-top:7px;font-weight:300}

  .body{padding:8px 36px 42px}

  /* Servicios grid ‚Äî cada card activa campos condicionales */
  .srv-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:6px}
  .srv{border:1.5px solid var(--border);border-radius:14px;padding:13px 14px;cursor:pointer;transition:all .22s;background:#fff;display:flex;align-items:center;gap:11px}
  .srv:hover{border-color:#4ECDC4;background:#F2FFFE}
  .srv.sel{border-color:#4ECDC4;background:linear-gradient(135deg,#F0FFFE,#F3ECFF);box-shadow:0 2px 14px rgba(78,205,196,.18)}
  .srv .ico{font-size:1.35rem}
  .srv .lbl{font-size:.82rem;font-weight:600;color:var(--text)}

  /* Campos condicionales por servicio */
  .cond{display:none;animation:fadeIn .3s ease}
  .cond.on{display:block}
  @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

  .sec{font-family:'Cormorant Garamond',serif;font-size:1.08rem;font-weight:600;color:var(--lila-deep);margin-bottom:15px;padding-bottom:8px;border-bottom:1px dashed var(--border)}
  .grp{margin-bottom:15px}
  label{display:block;font-size:.75rem;font-weight:600;color:var(--muted);letter-spacing:.06em;text-transform:uppercase;margin-bottom:6px}
  label em{color:var(--rosa);font-style:normal}
  input,select,textarea{width:100%;padding:12px 15px;border:1.5px solid var(--border);border-radius:12px;font-family:'Jost',sans-serif;font-size:.93rem;color:var(--text);background:#fff;outline:none;transition:border .2s,box-shadow .2s;appearance:none}
  input::placeholder,textarea::placeholder{color:#B8D6D2}
  input:focus,select:focus,textarea:focus{border-color:#4ECDC4;box-shadow:0 0 0 4px rgba(78,205,196,.1)}
  select{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='7'%3E%3Cpath d='M1 1l4.5 4.5L10 1' stroke='%234ECDC4' stroke-width='1.6' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 14px center;padding-right:38px;cursor:pointer}
  textarea{resize:vertical;min-height:78px}
  .two{display:grid;grid-template-columns:1fr 1fr;gap:13px}
  .three{display:grid;grid-template-columns:1fr 1fr 1fr;gap:11px}
  .sep{border:none;border-top:1px dashed var(--border);margin:20px 0}

  .btn{width:100%;margin-top:10px;padding:15px;background:linear-gradient(135deg,#4ECDC4,#A67FFF);color:#fff;border:none;border-radius:50px;font-family:'Jost',sans-serif;font-size:1rem;font-weight:600;letter-spacing:.04em;cursor:pointer;transition:opacity .2s,transform .18s;box-shadow:0 6px 22px rgba(78,205,196,.3)}
  .btn:hover:not(:disabled){opacity:.92;transform:translateY(-2px)}
  .btn:disabled{opacity:.55;cursor:not-allowed;transform:none;box-shadow:none}
  .fb{display:none;margin-top:16px;padding:14px 18px;border-radius:13px;font-size:.88rem;text-align:center;line-height:1.6}
  .fb.ok{background:#EDFAF4;color:#1B6B42;border:1px solid #9FDFBE}
  .fb.err{background:#FFF0F5;color:#B5294A;border:1px solid #F7AABF}
  .spin{display:inline-block;width:15px;height:15px;border:2px solid rgba(255,255,255,.35);border-top-color:#fff;border-radius:50%;animation:spin .6s linear infinite;vertical-align:middle;margin-right:7px}
  @keyframes spin{to{transform:rotate(360deg)}}
  @media(max-width:480px){.hdr{padding:26px 20px 40px}.body{padding:6px 20px 32px}.two,.three,.srv-grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="card">
  <div class="hdr">
    <div class="badge">üè¢ Empresas</div>
    <h1>Solicita tu Cotizaci√≥n</h1>
    <p>Programas integrales de bienestar emocional para tu organizaci√≥n</p>
  </div>
  <div class="body">
    <form id="form" novalidate>

      <!-- ‚îÄ‚îÄ Col I: Servicio ‚îÄ‚îÄ selector principal -->
      <p class="sec">¬øQu√© servicio necesitas?</p>
      <input type="hidden" id="Servicio" value="">
      <div class="srv-grid">
        <div class="srv" onclick="selServ(this,'Acompa√±amiento psicol√≥gico','acomp')">
          <span class="ico">üí¨</span><span class="lbl">Acompa√±amiento psicol√≥gico</span>
        </div>
        <div class="srv" onclick="selServ(this,'Talleres y capacitaciones','taller')">
          <span class="ico">üß†</span><span class="lbl">Talleres y capacitaciones</span>
        </div>
        <div class="srv" onclick="selServ(this,'Pl√°ticas y conferencias','platica')">
          <span class="ico">üé§</span><span class="lbl">Pl√°ticas y conferencias</span>
        </div>
        <div class="srv" onclick="selServ(this,'Evaluaciones','eval')">
          <span class="ico">üìã</span><span class="lbl">Evaluaciones</span>
        </div>
      </div>

      <!-- ‚îÄ‚îÄ Campos: Acompa√±amiento ‚Üí Col J K L M ‚îÄ‚îÄ -->
      <div class="cond" id="c-acomp" style="margin-top:14px">
        <div class="two">
          <!-- Col J: Num_Colaboradores -->
          <div class="grp">
            <label>N¬∫ colaboradores</label>
            <input type="number" id="Num_Colaboradores" min="1" placeholder="Ej. 50">
          </div>
          <!-- Col M: Modalidad_Atencion -->
          <div class="grp">
            <label>Modalidad</label>
            <select id="Modalidad_Atencion">
              <option value="">Elige‚Ä¶</option>
              <option>Presencial</option><option>En l√≠nea</option><option>H√≠brida</option>
            </select>
          </div>
        </div>
        <!-- Col K: Motivo_Atencion -->
        <div class="grp">
          <label>Motivo de atenci√≥n</label>
          <input type="text" id="Motivo_Atencion" placeholder="Ej. Estr√©s laboral, conflictos de equipo‚Ä¶">
        </div>
        <!-- Col L: Casos_Derivados -->
        <div class="grp">
          <label>Casos derivados</label>
          <input type="text" id="Casos_Derivados" placeholder="Ej. Ausentismo, bajo rendimiento‚Ä¶">
        </div>
      </div>

      <!-- ‚îÄ‚îÄ Taller ‚Üí Col N ‚îÄ‚îÄ -->
      <div class="cond" id="c-taller" style="margin-top:14px">
        <div class="grp">
          <label>Temas de inter√©s para el taller</label>
          <!-- Col N: Temas_Taller -->
          <input type="text" id="Temas_Taller" placeholder="Ej. Manejo del estr√©s, burnout, comunicaci√≥n‚Ä¶">
        </div>
        <!-- Col T: Num_Participantes -->
        <div class="grp">
          <label>N¬∫ de participantes</label>
          <input type="number" id="Num_Participantes_T" min="1" placeholder="Ej. 30">
        </div>
      </div>

      <!-- ‚îÄ‚îÄ Pl√°tica/Conferencia ‚Üí Col O P ‚îÄ‚îÄ -->
      <div class="cond" id="c-platica" style="margin-top:14px">
        <div class="grp">
          <!-- Col O: Tema_Platica -->
          <label>Tema de la pl√°tica</label>
          <input type="text" id="Tema_Platica" placeholder="Ej. Inteligencia emocional en el trabajo‚Ä¶">
        </div>
        <div class="grp">
          <!-- Col P: Tema_Conferencia -->
          <label>Tema de la conferencia</label>
          <input type="text" id="Tema_Conferencia" placeholder="Ej. Bienestar organizacional‚Ä¶">
        </div>
        <div class="grp">
          <!-- Col T: Num_Participantes -->
          <label>N¬∫ de participantes</label>
          <input type="number" id="Num_Participantes_P" min="1" placeholder="Ej. 80">
        </div>
      </div>

      <!-- ‚îÄ‚îÄ Evaluaci√≥n ‚Üí Col Q R S ‚îÄ‚îÄ -->
      <div class="cond" id="c-eval" style="margin-top:14px">
        <div class="two">
          <!-- Col Q: Tipo_Evaluacion -->
          <div class="grp">
            <label>Tipo de evaluaci√≥n</label>
            <input type="text" id="Tipo_Evaluacion" placeholder="Ej. Clima organizacional">
          </div>
          <!-- Col S: Num_Evaluaciones -->
          <div class="grp">
            <label>N¬∫ a evaluar</label>
            <input type="number" id="Num_Evaluaciones" min="1" placeholder="Ej. 20">
          </div>
        </div>
        <!-- Col R: Perfil_Evaluar -->
        <div class="grp">
          <label>Perfil a evaluar</label>
          <input type="text" id="Perfil_Evaluar" placeholder="Ej. Personal operativo, l√≠deres‚Ä¶">
        </div>
      </div>

      <hr class="sep">
      <p class="sec">Datos de la empresa</p>

      <div class="two">
        <!-- Col C: Nombre_Empresa -->
        <div class="grp">
          <label>Nombre de la empresa <em>*</em></label>
          <input type="text" id="Nombre_Empresa" placeholder="Empresa S.A." required>
        </div>
        <!-- Col D: Giro -->
        <div class="grp">
          <label>Giro</label>
          <input type="text" id="Giro" placeholder="Ej. Manufactura, TI‚Ä¶">
        </div>
      </div>

      <hr class="sep">
      <p class="sec">Datos de contacto</p>

      <div class="two">
        <!-- Col E: Nombre_Contacto -->
        <div class="grp">
          <label>Nombre del contacto <em>*</em></label>
          <input type="text" id="Nombre_Contacto" placeholder="Tu nombre" required>
        </div>
        <!-- Col F: Cargo -->
        <div class="grp">
          <label>Cargo</label>
          <input type="text" id="Cargo" placeholder="Ej. Recursos Humanos">
        </div>
      </div>
      <div class="two">
        <!-- Col G: Telefono -->
        <div class="grp">
          <label>Tel√©fono <em>*</em></label>
          <input type="tel" id="Telefono" placeholder="10 d√≠gitos" required>
        </div>
        <!-- Col H: Correo -->
        <div class="grp">
          <label>Correo</label>
          <input type="email" id="Correo" placeholder="contacto@empresa.com">
        </div>
      </div>

      <!-- Col U: Modalidad_General -->
      <div class="grp">
        <label>Modalidad general preferida</label>
        <select id="Modalidad_General">
          <option value="">Selecciona‚Ä¶</option>
          <option>Presencial</option><option>En l√≠nea</option><option>H√≠brida</option>
        </select>
      </div>
      <!-- Col V: Comentarios -->
      <div class="grp">
        <label>Comentarios adicionales</label>
        <textarea id="Comentarios" placeholder="Cualquier detalle que quieras agregar‚Ä¶"></textarea>
      </div>

      <!-- A=Timestamp ¬∑ B=ID_Empresa ¬∑ W=Estado  ‚Üí generados en servidor -->

      <button type="submit" class="btn" id="btn">Solicitar cotizaci√≥n ‚Üí</button>
      <div class="fb" id="fb"></div>
    </form>
  </div>
</div>

<script>
  // ‚îÄ‚îÄ Precargar datos desde URL (viene de be-welcome) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  (function() {
    var p = new URLSearchParams(window.location.search);
    // nombre ‚Üí Nombre_Contacto  |  telefono ‚Üí Telefono  |  correo ‚Üí Correo
    var map = {
      nombre:   'Nombre_Contacto',
      telefono: 'Telefono',
      correo:   'Correo'
    };
    Object.keys(map).forEach(function(key) {
      var val = p.get(key);
      var el  = document.getElementById(map[key]);
      if (val && el) {
        el.value = decodeURIComponent(val);
        if (key === 'correo') {
          el.readOnly = true;
          el.style.background = '#F2FFFE';
          el.style.color = '#1A6A5A';
          el.style.fontWeight = '500';
          el.style.borderColor = '#D8F0EC';
        }
      }
    });
    window.BE_PACIENTE_ID = p.get('id')    || '';
    window.BE_SESION_ID   = p.get('sesion')|| '';
    window.BE_MODAL       = p.get('modal') || 'Empresa';
    window.BE_TIPO        = p.get('tipo')  || 'EMP';
  })();

  var PROXY = 'TU_URL_WEBAPP_AQUI'; // ‚Üê reemplaza con tu URL desplegada
  var srvActivo = '';

  function selServ(el, srv, key) {
    document.querySelectorAll('.srv').forEach(function(s){ s.classList.remove('sel'); });
    el.classList.add('sel');
    srvActivo = srv;
    document.getElementById('Servicio').value = srv;
    ['acomp','taller','platica','eval'].forEach(function(k){
      document.getElementById('c-'+k).classList.toggle('on', k === key);
    });
  }

  document.getElementById('form').addEventListener('submit', function(e) {
    e.preventDefault();
    if (!srvActivo)                                        return fb('err','‚ö†Ô∏è Selecciona un servicio.');
    if (!g('Nombre_Empresa') || !g('Nombre_Contacto') || !g('Telefono')) return fb('err','‚ö†Ô∏è Completa los campos obligatorios.');
    setBtn(true);

    // Mapeado exacto columnas Sheet Cotizaciones_Empresas:
    // A=Timestamp(svr) | B=ID_Empresa(svr) | C=Nombre_Empresa | D=Giro
    // E=Nombre_Contacto | F=Cargo | G=Telefono | H=Correo | I=Servicio
    // J=Num_Colaboradores | K=Motivo_Atencion | L=Casos_Derivados | M=Modalidad_Atencion
    // N=Temas_Taller | O=Tema_Platica | P=Tema_Conferencia | Q=Tipo_Evaluacion
    // R=Perfil_Evaluar | S=Num_Evaluaciones | T=Num_Participantes | U=Modalidad_General
    // V=Comentarios | W=Estado(svr)
    var data = {
      nombreEmpresa:     g('Nombre_Empresa'),
      giro:              g('Giro'),
      nombreContacto:    g('Nombre_Contacto'),
      cargo:             g('Cargo'),
      telefono:          g('Telefono'),
      correo:            g('Correo'),
      servicio:          srvActivo,
      numColaboradores:  g('Num_Colaboradores'),
      motivoAtencion:    g('Motivo_Atencion'),
      casosDerivados:    g('Casos_Derivados'),
      modalidadAtencion: g('Modalidad_Atencion'),
      temasTaller:       g('Temas_Taller'),
      temaPlatica:       g('Tema_Platica'),
      temaConferencia:   g('Tema_Conferencia'),
      tipoEvaluacion:    g('Tipo_Evaluacion'),
      perfilEvaluar:     g('Perfil_Evaluar'),
      numEvaluaciones:   g('Num_Evaluaciones'),
      numParticipantes:  g('Num_Participantes_T') || g('Num_Participantes_P'),
      modalidadGeneral:  g('Modalidad_General'),
      comentarios:       g('Comentarios')
    };

    fetch(PROXY, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ action:'procesarCotizacionEmpresa', data:data })
    })
    .then(function(r){ return r.json(); })
    .then(function(res){
      if (res.ok) {
        fb('ok','‚úÖ ¬°Cotizaci√≥n enviada! Pronto te contactaremos.<br><small>ID: '+res.id+'</small>');
        document.getElementById('form').reset();
        document.querySelectorAll('.srv').forEach(function(s){ s.classList.remove('sel'); });
        document.querySelectorAll('.cond').forEach(function(c){ c.classList.remove('on'); });
        srvActivo=''; document.getElementById('Servicio').value='';
      } else {
        fb('err','‚ùå '+(res.error||'Error al enviar. Intenta de nuevo.'));
      }
    })
    .catch(function(){ fb('err','‚ùå Error de conexi√≥n.'); })
    .finally(function(){ setBtn(false); });
  });

  function g(id){ var el=document.getElementById(id); return el ? el.value.trim() : ''; }
  function fb(tipo,msg){ var el=document.getElementById('fb'); el.className='fb '+tipo; el.innerHTML=msg; el.style.display='block'; el.scrollIntoView({behavior:'smooth',block:'nearest'}); }
  function setBtn(l){ var b=document.getElementById('btn'); b.disabled=l; b.innerHTML=l?'<span class="spin"></span>Enviando‚Ä¶':'Solicitar cotizaci√≥n ‚Üí'; }
</script>
</body>
</html>

